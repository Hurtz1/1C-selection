# Сравнение файлов двух директорий

## Автор

Дмитриев Иван Дмитриевич  

Номер задачи: 4 (Системное программирование)

---

## Постановка задачи

Есть две директории, каждая содержит набор бинарных файлов (без вложенных папок).  
Необходимо, игнорируя имена файлов, определить:

1. Пары идентичных файлов из первой и второй директории.  
2. Пары файлов, которые похожи друг на друга не менее чем на заданный процент.  
3. Файлы, которые есть в директории 1, но которых нет в директории 2.  
4. Файлы, которые есть в директории 2, но которых нет в директории 1.

Процент сходства задаётся пользователем и трактуется как доля совпадающих байтов относительно размера большего из двух файлов.

Пример из условия:  
файл1 = `ABA`, файл2 = `B` → совпадает один байт, размер большего файла 3 → сходство 1 / 3 = 33.33%.

---

## Используемые технологии

- Язык: Python 3 (рекомендуется Python 3.10+)
- Модули стандартной библиотеки:
  - `os` — обход директорий и работа с путями
  - `sys` — чтение аргументов командной строки
  - `hashlib` — вычисление SHA-256 хэша для проверки идентичности файлов

---

## Структура репозитория

- `solution.py` — основной скрипт с решением задачи.
- `README.md` — этот файл.
- `test/` — директория с автотестами:
  - `test_solution.py` — набор юнит-тестов для проверки логики `solution.py`.

---

## Как запустить решение

### Требования

- Установленный Python 3.
- Две директории с файлами, которые нужно сравнить:
  - без вложенных папок;
  - размер каждого файла ≤ 10 МБ.

### Запуск

Из корня репозитория:

```bash
python3 solution.py <path_to_dir1> <path_to_dir2> <similarity_threshold>
```

Где:

- `<path_to_dir1>` — путь к первой директории.
- `<path_to_dir2>` — путь ко второй директории.
- `<similarity_threshold>` — число (целое или с плавающей точкой) от 0 до 100 — минимальный процент сходства, при котором файлы считаются «похожими».

Пример:

```bash
python3 solution.py data/disk1 data/disk2 70
```

---

## Формат вывода

Скрипт печатает в стандартный вывод строки в несколько групп:

1. **Идентичные файлы**:

   ```text
   <dir1>/<file1> - <dir2>/<file2>
   ```

2. **Похожие файлы** (с процентом сходства ≥ порога):

   ```text
   <dir1>/<file1> - <dir2>/<file2> - <similarity_percent>
   ```

3. **Файлы, уникальные для директории 1**:

   ```text
   <dir1>/<file_only_in_dir1>
   ```

4. **Файлы, уникальные для директории 2**:

   ```text
   <dir2>/<file_only_in_dir2>
   ```

---

## О принятых проектных решениях

- Скрипт принимает три аргумента: путь к первой директории, путь ко второй и порог похожести в процентах.
- Для каждого файла считаю:
  - размер в байтах;
  - SHA-256 хэш содержимого (через `hashlib`) для проверки полной идентичности;
  - гистограмму байтов (массив из 256 счётчиков).
- Сначала нахожу пары идентичных файлов по совпадению размера и SHA-256, такие пары сразу помечаются и выводятся.
- Для остальных файлов считаю процент сходства как отношение суммы минимумов по гистограммам к размеру большего файла, умноженное на 100.
- Пары с процентом ≥ заданного порога считаются похожими и выводятся с указанием процента.
- Файлы, которые не вошли ни в одну пару, считаются файлами, которые есть только в одной из директорий, и выводятся отдельно для каждой директории.

---

## Тесты

В директории `test/` находится файл `test_solution.py` с юнит-тестами на базе стандартного модуля `unittest`.  
Тесты создают временные директории и файлы, запускают `solution.py` с разными параметрами и проверяют:

- корректное нахождение идентичных файлов;
- корректный подсчёт процента схожести для похожих файлов;
- корректное определение файлов, уникальных для каждой директории;
- влияние порога похожести на включение/исключение пар в результат.

### Как запустить тесты

Из корня репозитория:

```bash
python3 -m unittest discover -s test
```

Либо запустить конкретный файл с тестами:

```bash
python3 -m unittest test.test_solution
```

Успешное прохождение тестов подтверждает корректность работы решения в основных сценариях.